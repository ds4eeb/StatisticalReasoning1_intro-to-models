---
title: "Activity 9: Statistical reasoning 1: intro to models"
subtitle: Feb. 4th, 2026, Calvin Munson
format: gfm
execute:
  warning: false
editor: source
---

------------------------------------------------------------------------

You will submit two outputs for this activity:

1.  A **PDF** of a rendered Quarto document with all of your R code. Please create a new Quarto document (e.g. don't use this `README.qmd`), include all of the code that appears in this document, in addition to adding your own code and **answers to all of the questions** in the "Q#" sections. Submit this through Gradescope.

2.  A plot and your answers from the final section. Submit that content to the google slide below: <https://docs.google.com/presentation/d/1AJVu0eq5-OoRGi4UlBervrqKbFHOINvAB-8u0JaFzYM/edit?usp=sharing>

*If you have trouble submitting as a PDF, please ask Calvin or Malin for help. If we still can't solve it, you can submit the .qmd file instead.*

A reminder: **Please label the code** in your final submission in two ways: 1) denote your answers to each question using headers that correspond to the question you're answering and 2) thoroughly "comment" your code: remember, this means annotating your code directly by typing descriptions of what each line does after a `#`. This will help future you!

------------------------------------------------------------------------

Let's start by reading in the relevant packages

```{r}
library(brms) # for statistics
library(tidyverse)
library(ggeffects) # for the prediction plot
library(lterdatasampler)

```

```{r}


# latitude
m.crab.watersd <- 
  brm(data = pie_crab, 
      family = gaussian,
      size ~ water_temp_sd,
      iter = 2000, warmup = 1000, chains = 4, cores = 4,
      seed = 4,
      file = "output/m.crab.watersd")

plot(m.crab.watersd) # show posteriors and chains
summary(m.crab.watersd)
m.crab.watersd$fit

```

------------------------------------------------------------------------

# 1. Fiddler crabs

Fiddler crab picture here

The data today is fiddler crab size data from 13 salt marshes from Florida to Massachusetts. Crab size was measured as carapace width. Air and water temperature data from nearby monitoring programs are also included.

```{r}
head(pie_crab)
```

------------------------------------------------------------------------

## 1.1 Plot data, pick the model

The first step is to graph our data so we can have a visual sense of what's going on. Let's say that our ultimate goal is to understand whether the size of crabs changes with latitude in a test of Bergmann's rule:

> “One of the best-known patterns in biogeography is Bergmann’s rule. It predicts that organisms at higher latitudes are larger than ones at lower latitudes. Many organisms follow Bergmann’s rule, including insects, birds, snakes, marine invertebrates, and terrestrial and marine mammals. What drives Bergmann’s rule? Bergmann originally hypothesized that the organisms he studied, birds, were larger in the colder, higher latitudes due to heat-conservation. But the heat-conservation hypothesis relies on internal regulation of body temperature and therefore does not apply to ectotherms, some of which also follow Bergmann’s rule. There is likely no universal mechanism underpinning Bergmann’s rule, regardless of ecto- or endothermy. As a result, other mechanisms have been proposed to explain Bergmann’s rule, including the starvation-resistant hypothesis, the diet-quality hypothesis, the enemy hypothesis, the resource rule, seasonality hypothesis, and the temperature–size rule (Johnson et al., 2019).”

To start, let's plot carapace width (`size`) on the y axis with `latitude` on the x axis.

```{r}
pie_crab %>% 
  ggplot(aes(x = latitude, y = size)) +
  geom_point() +
  # Make the y-axis include 0
  ylim(0, NA)
```

------------------------------------------------------------------------

### Q1.1 Interpret the graph

Interpret this graph: Does it look like size increases with latitude? Describe how confident you are in this interpretation.

------------------------------------------------------------------------

### Q1.2 Beautify this graph

Make this graph look a bit nicer!

```{r}

```

---------

Now that you've spent some time pondering the data, let's put together our first model. From lecture, linear models follow the equation:

$y = intercept + slope*x$

Let's set up our model to look like:

$size = intercept + slope*latitude$



------------------------------------------------------------------------

## 1.2 Fit linear regression with `brms`

------------------------------------------------------------------------

```{r}
# latitude
m.crab.lat <- 
  brm(data = pie_crab, 
      family = gaussian,
      size ~ latitude,
      iter = 2000, warmup = 1000, chains = 4, cores = 4,
      seed = 4,
      file = "output/m.crab.lat")

plot(m.crab.lat) # show posteriors and chains
summary(m.crab.lat)
m.crab.lat$fit
```


## 1.3 Assess model

------------------------------------------------------------------------

## 1.4 Interpret model

------------------------------------------------------------------------

## 1.5 Plot model on the data

------------------------------------------------------------------------

# 2.

### Q2.10 Export graphs

Export both graphs and both interpretations to this slide deck: <https://docs.google.com/presentation/d/1AJVu0eq5-OoRGi4UlBervrqKbFHOINvAB-8u0JaFzYM/edit?usp=sharing>

### Render to PDF

And submit the well-labeled PDF on Gradescope. Thanks!

```{r}


lterdatasampler::nwt_pikas

nwt_pikas %>% 
  ggplot(aes(x = date, y = concentration_pg_g)) +
  geom_point()
```

m.p.1 \<- brm(data = nwt_pikas, family = gaussian, concentration_pg_g \~ date, iter = 2000, warmup = 1000, chains = 4, cores = 4, seed = 4, file = "output/m.p.1")

plot(m.p.1) \# show posteriors and chains summary(m.p.1) m.p.1\$fit

# Elevation model

m.p.elev \<- brm(data = nwt_pikas, family = gaussian, concentration_pg_g \~ elev_m, iter = 2000, warmup = 1000, chains = 4, cores = 4, seed = 4, file = "output/m.p.elev")

plot(m.p.elev) \# show posteriors and chains summary(m.p.elev) m.p.elev\$fit \`\`\`
